<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 4 Recitation 4 | Introduction to R</title>
<meta name="author" content="Tptrix29">
<meta name="description" content="Today you learned… pivots: pivot_longer(), pivot_wider() joins: right_join(), left_join(), inner_join(), full_join() This worksheet will help you get accustomed to using these functions to...">
<meta name="generator" content="bookdown 0.39 with bs4_book()">
<meta property="og:title" content="Chapter 4 Recitation 4 | Introduction to R">
<meta property="og:type" content="book">
<meta property="og:url" content="https://bookdown.org/janedoe/bookdown-demo/recitation-4.html">
<meta property="og:image" content="https://bookdown.org/janedoe/bookdown-demo/_main_files/img/R_logo.png">
<meta property="og:description" content="Today you learned… pivots: pivot_longer(), pivot_wider() joins: right_join(), left_join(), inner_join(), full_join() This worksheet will help you get accustomed to using these functions to...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 4 Recitation 4 | Introduction to R">
<meta name="twitter:description" content="Today you learned… pivots: pivot_longer(), pivot_wider() joins: right_join(), left_join(), inner_join(), full_join() This worksheet will help you get accustomed to using these functions to...">
<meta name="twitter:image" content="https://bookdown.org/janedoe/bookdown-demo/_main_files/img/R_logo.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.5.1/transition.js"></script><script src="libs/bs3compat-0.5.1/tabs.js"></script><script src="libs/bs3compat-0.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="styles.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Introduction to R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Home</a></li>
<li><a class="" href="recitation-1.html"><span class="header-section-number">1</span> Recitation 1</a></li>
<li><a class="" href="recitation-2.html"><span class="header-section-number">2</span> Recitation 2</a></li>
<li><a class="" href="recitation-3.html"><span class="header-section-number">3</span> Recitation 3</a></li>
<li><a class="active" href="recitation-4.html"><span class="header-section-number">4</span> Recitation 4</a></li>
<li><a class="" href="recitation-5.html"><span class="header-section-number">5</span> Recitation 5</a></li>
<li><a class="" href="recitation-6.html"><span class="header-section-number">6</span> Recitation 6</a></li>
<li><a class="" href="recitation-7.html"><span class="header-section-number">7</span> Recitation 7</a></li>
<li><a class="" href="recitation-8.html"><span class="header-section-number">8</span> Recitation 8</a></li>
<li><a class="" href="recitation-9.html"><span class="header-section-number">9</span> Recitation 9</a></li>
<li><a class="" href="recitation-10.html"><span class="header-section-number">10</span> Recitation 10</a></li>
<li><a class="" href="recitation-11.html"><span class="header-section-number">11</span> Recitation 11</a></li>
<li><a class="" href="final-review.html"><span class="header-section-number">12</span> Final Review</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/Tptrix29/r-tutorials">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="recitation-4" class="section level1" number="4">
<h1>
<span class="header-section-number">4</span> Recitation 4<a class="anchor" aria-label="anchor" href="#recitation-4"><i class="fas fa-link"></i></a>
</h1>
<p><strong>Today you learned…</strong></p>
<ul>
<li>pivots: <em>pivot_longer()</em>, <em>pivot_wider()</em>
</li>
<li>joins: <em>right_join()</em>, <em>left_join()</em>, <em>inner_join()</em>, <em>full_join()</em>
</li>
</ul>
<p>This worksheet will help you get accustomed to using these functions to manipulate data.</p>
<p>Load any necessary packages in your first chunk of code.</p>
<p>Now, with your partner, please work out the following exercises sequentially. There may be more than one way to code the exercises.</p>
<div id="part-i-2" class="section level2" number="4.1">
<h2>
<span class="header-section-number">4.1</span> Part I<a class="anchor" aria-label="anchor" href="#part-i-2"><i class="fas fa-link"></i></a>
</h2>
<ol start="0" style="list-style-type: decimal">
<li>Load the data you’ll need for Part I by simply running the code below.</li>
</ol>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">year</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fl">2001</span><span class="op">:</span><span class="fl">2020</span><span class="op">)</span></span>
<span><span class="va">team</span> <span class="op">&lt;-</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">num</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">yr_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">num</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html">set_names</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span></span>
<span></span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span></span>
<span></span>
<span><span class="va">tbi_age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-24/tbi_age.csv"</span><span class="op">)</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Add <code>index</code> to the <code>yr_data</code> data frame via binding. Call the index column in the resulting data frame <code>idx</code>.</li>
</ol>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">yr_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op">(</span>idx <span class="op">=</span> <span class="va">index</span>, <span class="va">yr_data</span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Is the data currently in wide or long format? Justify your answer with a complete sentence.</li>
</ol>
<p>[WIDE.]</p>
<ol start="3" style="list-style-type: decimal">
<li>Create one <code>year</code> column and put all data currently stored in columns 2001 to 2020 into a column called <code>points</code>. Save this updated data frame as <code>yr_data_long</code>.</li>
</ol>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">yr_data_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="va">yr_data</span>,</span>
<span>                            cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fl">2001</span><span class="op">:</span><span class="fl">2020</span><span class="op">)</span>,</span>
<span>                            names_to <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>                            values_to <span class="op">=</span> <span class="st">"points"</span><span class="op">)</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>View the <code>tbi_age</code> data and decide what format it’s in. Justify your answer.</li>
</ol>
<p>[LONG.]</p>
<ol start="5" style="list-style-type: decimal">
<li>Transform this data so that we can see <code>number_est</code> for each age group along with <code>type</code> and <code>injury_mechanism</code>, like below. Save this data frame as <code>tbi_wide</code>.</li>
</ol>
<pre><code>## # A tibble: 21 x 13
##    type  injury_mechanism  0-17   0-4&lt;code&gt;   5-14&lt;/code&gt;   15-24   25-34   35-44   45-54
##    &lt;chr&gt; &lt;chr&gt;             &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1 Emer~ Motor Vehicle C~  47138   5464  19785  103892   71641   44108   40020
##  2 Emer~ Unintentional F~ 397190 230776 133084   96568   70210   68830   95127
##  3 Emer~ Unintentionally~ 229236  53436 120839  106679   44404   32479   30495
##  4 Emer~ Other unintenti~  55785  12007  30656   37118   22360   17541   17808
##  5 Emer~ Intentional sel~     NA     NA     NA     870     650     421     247
##  6 Emer~ Assault           24360    674   9690   65399   57213   34100   27682
##  7 Emer~ Other or no mec~  57983  19360  26022   33395   20974   16503   15962
##  8 Hosp~ Motor Vehicle C~   5830    870   2395   12925   11050    7305    8490
##  9 Hosp~ Unintentional F~   7935   4700   2270    3910    4470    5640   12010
## 10 Hosp~ Unintentionally~   1985    510    980    1070     635     610     685
## # ... with 11 more rows, and 4 more variables</code></pre>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbi_wide</span> <span class="op">&lt;-</span> <span class="va">tbi_age</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    id_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, </span>
<span>    names_from <span class="op">=</span> <span class="va">age_group</span>,</span>
<span>    values_from <span class="op">=</span> <span class="va">number_est</span><span class="op">)</span></span>
<span><span class="va">tbi_wide</span></span></code></pre></div>
<pre><code>## # A tibble: 21 × 13
##    type   injury_mechanism `0-17`  `0-4` `5-14` `15-24` `25-34` `35-44` `45-54` `55-64`
##    &lt;chr&gt;  &lt;chr&gt;             &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1 Emerg… Motor Vehicle C…  47138   5464  19785  103892   71641   44108   40020   27193
##  2 Emerg… Unintentional F… 397190 230776 133084   96568   70210   68830   95127  112460
##  3 Emerg… Unintentionally… 229236  53436 120839  106679   44404   32479   30495   20408
##  4 Emerg… Other unintenti…  55785  12007  30656   37118   22360   17541   17808   12928
##  5 Emerg… Intentional sel…     NA     NA     NA     870     650     421     247     105
##  6 Emerg… Assault           24360    674   9690   65399   57213   34100   27682   11538
##  7 Emerg… Other or no mec…  57983  19360  26022   33395   20974   16503   15962   13387
##  8 Hospi… Motor Vehicle C…   5830    870   2395   12925   11050    7305    8490    7280
##  9 Hospi… Unintentional F…   7935   4700   2270    3910    4470    5640   12010   18490
## 10 Hospi… Unintentionally…   1985    510    980    1070     635     610     685     765
## # ℹ 11 more rows
## # ℹ 3 more variables: `65-74` &lt;dbl&gt;, `75+` &lt;dbl&gt;, Total &lt;dbl&gt;</code></pre>
</div>
<div id="part-ii-1" class="section level2" number="4.2">
<h2>
<span class="header-section-number">4.2</span> Part II<a class="anchor" aria-label="anchor" href="#part-ii-1"><i class="fas fa-link"></i></a>
</h2>
<p>In this example, we have a data frame with head counts for grain feeding producers and another data frame with head counts from grass feeding producers; there is potentially overlap between the producers that have both grain and grass fed animals and we want to merge them into one data frame. Note that producer number is not unique, but it is unique within state, so we need to merge on both state and producer number together.</p>
<ol start="0" style="list-style-type: decimal">
<li>Load the data for Part II by simply running the code below.</li>
</ol>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grass</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  producer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  state <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NSW"</span>, <span class="st">"NSW"</span>, <span class="st">"QLD"</span>, <span class="st">"QLD"</span><span class="op">)</span>,</span>
<span>  count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">59</span>, <span class="fl">82</span>, <span class="fl">37</span>, <span class="fl">28</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">grain</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  producer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  state <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NSW"</span>, <span class="st">"QLD"</span>, <span class="st">"NSW"</span>, <span class="st">"QLD"</span><span class="op">)</span>,</span>
<span>  count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">192</span>, <span class="fl">21</span>, <span class="fl">37</span>, <span class="fl">81</span><span class="op">)</span>,</span>
<span>  post_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"2680"</span>, <span class="st">"4700"</span>, <span class="st">"2650"</span>, <span class="st">"4715"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Keep all the observations that are present in the <code>grass</code> data frame and join it with the <code>grain</code> data frame using the code below. What does the argument <code>by = c("producer","state")</code> do?</li>
</ol>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gg_lj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">grass</span>, <span class="va">grain</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"producer"</span>, <span class="st">"state"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>[YOUR ANSWER HERE]</p>
<ol start="2" style="list-style-type: decimal">
<li>Add the argument <code>suffix = c("_grass", "_grain")</code> to the line of code below. What does this argument do?</li>
</ol>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gg_lj2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">grass</span>, <span class="va">grain</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"producer"</span>, <span class="st">"state"</span><span class="op">)</span>, </span>
<span>                    suffix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"_grass"</span>, <span class="st">"_grain"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>[YOUR ANSWER HERE]</p>
<ol start="3" style="list-style-type: decimal">
<li>Join the data frames by writing code that keeps all the observations that are present in <code>grain</code>.</li>
</ol>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gg_rj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">right_join</a></span><span class="op">(</span><span class="va">grass</span>, <span class="va">grain</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"producer"</span>, <span class="st">"state"</span><span class="op">)</span>, </span>
<span>                    suffix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"_grass"</span>, <span class="st">"_grain"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># OR</span></span>
<span></span>
<span><span class="va">gg_rj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">grain</span>, <span class="va">grass</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"producer"</span>, <span class="st">"state"</span><span class="op">)</span>, </span>
<span>                    suffix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"_grain"</span>, <span class="st">"_grass"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Are there any missing data? Why does this happen?</li>
</ol>
<p>Yes. The property of <code>left_join</code> and <code>right_join</code> caused that phenomenon. Some values occured in left(right) table don’t occur in right(left) table.</p>
<ol start="5" style="list-style-type: decimal">
<li>Use a join that keeps any observations that occur in either of the two data frames.</li>
</ol>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gg_fj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join</a></span><span class="op">(</span><span class="va">grass</span>, <span class="va">grain</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"producer"</span>, <span class="st">"state"</span><span class="op">)</span>, </span>
<span>                    suffix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"_grass"</span>, <span class="st">"_grain"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li>Looking at this merged data frame, can you tell whether producer 3 is a grass or grain feeding producer? How?</li>
</ol>
<p>Producer 3 belongs to grass feeding produce. Because there is no grain-feeding count of producer 3 is NA, which means there is no grain-feeding animals.</p>
<ol start="7" style="list-style-type: decimal">
<li>Use a join that keeps only observations that are present in both data frames.</li>
</ol>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gg_ij</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">grass</span>, <span class="va">grain</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"producer"</span>, <span class="st">"state"</span><span class="op">)</span>, </span>
<span>                    suffix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"_grass"</span>, <span class="st">"_grain"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<ol start="8" style="list-style-type: decimal">
<li>What are the dimensions of this merged data? Why do we see what we see?</li>
</ol>
<p>The dimension of merged data is 3, 5. We see such a result because <code>inner_join</code> function only output the data item occurring in both left and right dataframe.</p>
</div>
<div id="part-iii-bonus-questions" class="section level2" number="4.3">
<h2>
<span class="header-section-number">4.3</span> Part III (Bonus Questions)<a class="anchor" aria-label="anchor" href="#part-iii-bonus-questions"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>Clean the <code>tbi</code> data so that it contains the following age groups: 0-4, 5-17, 18-24, 25-34, 35-44, 45-54, 55-64, 65-74, 75+, and Total. Keep the data in wide format. Save your new data frame as <code>tbi_clean</code>.</li>
</ol>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbi_clean</span> <span class="op">&lt;-</span> <span class="va">tbi_wide</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>`5-17` <span class="op">=</span> <span class="va">`0-17`</span> <span class="op">-</span> <span class="va">`0-4`</span>,</span>
<span>         `18-24` <span class="op">=</span> <span class="va">Total</span> <span class="op">-</span> <span class="op">(</span><span class="va">`0-17`</span> <span class="op">+</span> <span class="va">`25-34`</span> <span class="op">+</span> <span class="va">`35-44`</span> <span class="op">+</span> </span>
<span>                              <span class="va">`45-54`</span> <span class="op">+</span> <span class="va">`55-64`</span> <span class="op">+</span> <span class="va">`65-74`</span> <span class="op">+</span> <span class="va">`75+`</span><span class="op">)</span> </span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">type</span>, <span class="va">injury_mechanism</span>, <span class="va">`0-4`</span>, <span class="va">`5-17`</span>, <span class="va">`18-24`</span>, <span class="va">`25-34`</span><span class="op">:</span><span class="va">Total</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check that the categories sum to the total</span></span>
<span><span class="va">tbi_clean</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Total2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="va">`0-4`</span><span class="op">:</span><span class="va">`75+`</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Total</span>, <span class="va">Total2</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 21 × 2
##      Total  Total2
##      &lt;dbl&gt;   &lt;dbl&gt;
##  1  334109  334109
##  2 1213412 1213412
##  3  433947  433947
##  4  164935  164935
##  5    2567    1423
##  6  210450  210450
##  7  172974  172974
##  8   58765   58765
##  9  150730  150730
## 10    7090    7090
## # ℹ 11 more rows</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Start with the farming data frame you created in Part II Q5. Add in the latitude and longitude associated with each post code in the data set. The code below will load in a file with lat and long info for each post code.</li>
</ol>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pcodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"http://garthtarr.com/data/aus_postcode_lat_long.csv"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>post_code <span class="op">=</span> <span class="va">postcode</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_location</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">gg_fj</span>, <span class="va">pcodes</span>, by <span class="op">=</span> <span class="st">"post_code"</span><span class="op">)</span></span></code></pre></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="recitation-3.html"><span class="header-section-number">3</span> Recitation 3</a></div>
<div class="next"><a href="recitation-5.html"><span class="header-section-number">5</span> Recitation 5</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#recitation-4"><span class="header-section-number">4</span> Recitation 4</a></li>
<li><a class="nav-link" href="#part-i-2"><span class="header-section-number">4.1</span> Part I</a></li>
<li><a class="nav-link" href="#part-ii-1"><span class="header-section-number">4.2</span> Part II</a></li>
<li><a class="nav-link" href="#part-iii-bonus-questions"><span class="header-section-number">4.3</span> Part III (Bonus Questions)</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/Tptrix29/r-tutorials/blob/master/4_rec.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/Tptrix29/r-tutorials/edit/master/4_rec.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Introduction to R</strong>" was written by Tptrix29. It was last built on 2024-07-13.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
